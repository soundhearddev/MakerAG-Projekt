<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Item Status</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        #status img {
            display: block;
            margin-top: 15px;
        }
        button {
            padding: 8px 12px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h1>Geräteübersicht</h1>

<div id="itemContainer">
    <div id="status">
        <p>Lade Daten...</p>
    </div>
</div>

<script>
// Beispiel: Laptop-ID aus URL holen (?id=1)
const params = new URLSearchParams(window.location.search);
const id = params.get("id") || 0;

fetch(`/api/get_item.php?id=${id}`)
  .then((res) => res.json())
  .then((data) => {
    if (data.error) {
      document.getElementById(
        "itemContainer"
      ).innerHTML = `<p>Fehler: ${data.message}</p>`;
      return;
    }

    const container = document.getElementById("status");
    container.innerHTML = ""; // Lade-Text entfernen

    // Titel + Marke + Modell
    const title = document.createElement("h2");
    title.textContent = `${data.brand} ${data.model}`;
    container.appendChild(title);

    // Kategorie + Subkategorie
    const cat = document.createElement("p");
    cat.innerHTML = `<strong>Kategorie:</strong> ${data.category} / ${data.subcategory}`;
    container.appendChild(cat);

    // Status + Zustand
    const status = document.createElement("p");
    status.innerHTML = `<strong>Status:</strong> ${data.status} | <strong>Zustand:</strong> ${data.item_condition}`;
    container.appendChild(status);

    // Standort
    const location = document.createElement("p");
    location.innerHTML = `<strong>Standort:</strong> Schrank ${data.location_schrank}, Regal ${data.location_regal}, Position ${data.location_position}`;
    container.appendChild(location);

    // Specs
    const specs = document.createElement("ul");
    specs.innerHTML = `
        <li><strong>Interfaces:</strong> ${data.interfaces}</li>
        <li><strong>Power:</strong> ${data.power}</li>
        <li><strong>Firmware:</strong> ${data.firmware_version}</li>
    `;
    container.appendChild(specs);

    // Tags
    if (data.tags) {
      const tags = document.createElement("p");
      tags.innerHTML = `<strong>Tags:</strong> ${data.tags}`;
      container.appendChild(tags);
    }

    // Notes
    if (data.notes) {
      const notes = document.createElement("p");
      notes.innerHTML = `<strong>Notizen:</strong> ${data.notes}`;
      container.appendChild(notes);
    }

    // Thumbnail
    if (data.thumbnail) {
      const img = document.createElement("img");
      img.src = data.thumbnail;
      img.style.height = "200px";
      container.appendChild(img);
    }

    // PDF Dokumente
    if (data.docs_link) {
      const pdf = document.createElement("div");
      pdf.innerHTML = `
        <button onclick="togglePdf(this)">Dokumente anzeigen</button>
        <div style="display:none; margin-top:10px;">
            <embed src="${data.docs_link}" type="application/pdf" width="100%" height="600px" />
            <p>Falls das PDF nicht angezeigt wird, 
            <a href="${data.docs_link}" target="_blank">hier öffnen</a> 
            oder <a href="${data.docs_link}" download>herunterladen</a>.
            </p>
        </div>
      `;
      container.appendChild(pdf);
    }
  })
  .catch((err) => {
    document.getElementById(
      "itemContainer"
    ).innerHTML = `<p>Fehler beim Laden: ${err}</p>`;
  });

// PDF Toggle Funktion
function togglePdf(btn) {
  const div = btn.nextElementSibling;
  div.style.display = div.style.display === "none" ? "block" : "none";
}
</script>

</body>
</html>
